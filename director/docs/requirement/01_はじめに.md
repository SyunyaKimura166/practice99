# DirectorAgent 要件定義書<!-- omit in toc -->

## 目次<!-- omit in toc -->

- [はじめに](#はじめに)
- [1. 概要：DirectorAgentの役割と位置づけ](#1-概要directoragentの役割と位置づけ)
  - [1.1. 目的](#11-目的)
  - [1.2. 参照](#12-参照)
  - [1.3. 概要](#13-概要)
  - [1.4. 特徴](#14-特徴)
  - [1.5. 実行契機について](#15-実行契機について)
  - [1.6. 優先度判断の注意事項](#16-優先度判断の注意事項)
  - [1.7. 技術スタック](#17-技術スタック)
- [2. DirectorAgentの概要](#2-directoragentの概要)
- [3. 機能要件](#3-機能要件)
- [4. 非機能要件](#4-非機能要件)
- [5. エージェント間インターフェース](#5-エージェント間インターフェース)
- [6. シーケンス図](#6-シーケンス図)

## はじめに

「戦闘力100倍プロジェクト」では、ソフトウェアの進化サイクルのコアとなる「DevOps」、「MLOps」、「不具合解析」に関してAIエージェントを用いることで、通常の100倍ほどの超効率化（ソフト外注で3ヵ月かかることを1日に短縮）を可能とする技術を開発することを目的とする。

そのうち本プロジェクト（AIエージェント活用自動ソフト開発プロジェクト）では、上記を実現するAIエージェントのフレームワークを試作し、まずは生産性の20~30倍向上（ソフト外注で1ヵ月かかることを1日に短縮）を目標とする。

本資料では、**DirectorAgent**の要件定義を記載する。DirectorAgentは、マルチエージェントシステム全体の**司令塔**として、GitHub Issuesに登録されたタスクの優先度を判断し、適切な専門エージェントにタスクを振り分ける役割を担っている。

## 1. 概要：DirectorAgentの役割と位置づけ

### 1.1. 目的

DirectorAgentは、ソフトウェア開発プロセスにおける意思決定の自動化と品質向上を担う中核エージェントである。その役割は、開発チームがより効率的かつ戦略的に作業を進められるよう、タスク管理とエージェント間調整を高度に自動化することにある。

- **開発タスクの自動優先度付け**: GitHub Issuesに登録された多数のタスクから、ビジネス価値と緊急度を総合的に判断し、最優先のタスクを自動選択
- **専門エージェントへの最適な振り分け**: タスクの種類（新機能開発、不具合修正等）に応じて、最適な専門エージェントに作業を依頼
- **人的リソースの効率化**: 従来は人が行っていた「次に何をすべきか」の判断を自動化し、開発者はより創造的な作業に集中可能

### 1.2. 参照

- [Tidy First? ―個人で実践する経験主義的ソフトウェア設計](https://www.oreilly.co.jp/books/9784814400911/)
- [GitHub Projects MCP Server](./mcp_tool/github_projects_mcp.py)
- [Issueテンプレート](./issue_template/template.md)
- [Claude Code Documentation](https://docs.anthropic.com/claude-code)
- [MCP (Model Context Protocol)](https://modelcontextprotocol.io/)

### 1.3. 概要

DirectorAgentの仕組みを検討するにあたり、システム全体の動作フローと核となる技術要素について整理し、GitHub ActionsとClaude Codeを使った実装方式を確立した。

**DirectorAgentの基本的な動作フロー**：
1. **GitHub Issuesからタスク取得**: 開発チームが作成したIssue（課題・要望）を自動で収集
2. **AI による内容理解と優先度判断**: Claude Opus 4.5 が各タスクの内容を理解し、ビジネス価値や緊急度を評価
3. **専門エージェントへの振り分け**: タスクの性質に応じて「開発担当エージェント」か「不具合修正担当エージェント」かを自動判断
4. **作業開始の準備**: 選択されたタスクのステータスを「準備完了」に変更し、担当エージェントが作業を開始できる状態にする

**DirectorAgentが解決する課題**：
- **優先度判断の属人化解消**: 「次に何をやるべきか」の判断基準を明確化し、一貫した優先度付けを実現
- **タスク振り分けの効率化**: 手動での担当者アサインを自動化し、適材適所での作業配分を実現
- **意思決定の透明性向上**: 優先度判断の根拠を明示し、チーム全体での理解促進

### 1.4. 特徴

DirectorAgentの特徴を以下に記載する。

1. **クラウドベースの自動実行システム**
   - GitHub Actionsを使用した自動実行環境
   - Claude Opus 4.5 AIモデルによる高度な自然言語理解
   - 24時間365日稼働可能な無人運用システム
   - 設定変更のみで動作パラメータを調整可能

2. **Issue管理の完全自動化**
   - GitHub Issuesから自動でタスク情報を収集
   - Issue内容の詳細解析（タイトル、本文、ラベル等を総合判断）
   - タスクの担当者自動設定
   - プロジェクト進捗ステータス自動更新
   - 人手による確認・承認作業を最小化

3. **AI による柔軟な優先度判断**
   - 従来の固定ルールではなく、AI が文章の意味を理解して判断
   - 顧客要求、セキュリティ、緊急度など複数観点を自動で総合評価
   - 「Tidy First?」設計思想による効率的なタスク順序決定
   - 新しい種類のタスクが追加されても自動対応可能

4. **専門分野に特化した振り分け**
   - タスク内容を解析し「新機能開発」「不具合修正」等を自動分類
   - それぞれに最適化された専門エージェントに作業を依頼
   - 開発・機能追加・リファクタ → DevPlanner Agents（開発計画エージェント）
   - 不具合・バグ修正 → 不具合分析 Agents（バグ解析エージェント）
   - 作業効率と品質の両立を実現

5. **変化に強い設計**
   - Issueテンプレートの変更に自動対応
   - ルールベースではなく意味理解による処理
   - 新しいプロジェクト要件にもスムーズに適応
   - システム改修なしでの運用継続が可能

### 1.5. 実行契機について

DirectorAgentは段階的に進化する実行契機を採用している。これにより、安全で確実なシステム導入と運用を実現する。

**Phase 1: 手動実行**
- **契機**: 開発者やプロジェクトマネージャーが必要に応じて手動で実行
- **方法**: GitHub ActionsのUIから「Run workflow」ボタンをクリック
- **適用場面**: システムの動作検証、緊急時の優先度判断、新機能のテスト
- **メリット**: 安全性が高く、実行タイミングを完全にコントロール可能

**Phase 2: 定期実行**
- **契機**: 設定されたスケジュール（例：6時間毎）で自動実行
- **方法**: GitHub Actionsのcron設定による定期実行
- **適用場面**: 安定運用段階での定期的なタスク管理
- **メリット**: 人の判断に依存せず、一定間隔でのタスク管理を実現

**Phase 3: 自動実行**
- **契機**: AI による総合的な状況判断に基づく自動実行
- **方法**: マネージャエージェントの稼働状況とタスクの緊急度を総合的に判断
- **適用場面**: 完全自動化された開発環境での無人運用
- **メリット**: 最適なタイミングでの実行により、システム全体の効率を最大化

### 1.6. 優先度判断の注意事項

DirectorAgentの優先度判断機能について、運用上重要な注意事項を記載する。

**⚠️ 計算式の暫定性について**

現在の優先度計算式は運用開始時の暫定的なものであり、**実際の運用データに基づく継続的な改善が前提**となっている：

```
現在の方式: 基本スコア = LLM総合評価スコア (1-10)
調整スコア = 基本スコア × 時間係数 × 依存関係係数
```

**運用中に発生する可能性のある調整**:
- **重み付けの調整**: 顧客要求、セキュリティ、緊急度等の観点別重み付けの最適化
- **評価基準の追加**: 新しい判定観点（技術的負債、市場競争力等）の追加
- **計算ロジックの改善**: 線形加算から多項式回帰や機械学習モデルへの発展
- **しきい値の調整**: スコア判定基準の組織・プロジェクト特性に合わせた調整

**継続的改善の仕組み**:
- 定期的な判定精度レビュー（月1回推奨）
- 実際のタスク完了結果との照合による妥当性検証
- プロジェクト特性の変化に応じた動的な調整
- ユーザーフィードバックに基づく改善提案の収集

**運用上の推奨事項**:
- システム導入初期は判定結果の人手による確認を推奨
- 優先度判断の根拠を記録し、改善のためのデータとして蓄積
- 組織やプロジェクトの特性に応じたカスタマイズの実施

### 1.7. 技術スタック

| 技術要素 | 使用技術 |
|----------|----------|
| 実行環境 | GitHub Actions |
| AIエージェント | Claude Code（Claude Opus 4.5） |
| GitHub連携 | GitHub Projects MCP Server (FastMCP) |
| 通信プロトコル | MCP (Model Context Protocol) |
| ステータス管理 | GitHub Projects V2 |

## 2. DirectorAgentの概要

DirectorAgentの概要、MCP（Model Context Protocol）サーバとの連携方式、優先度判断アルゴリズムについて記載。詳細は、[02_DirectorAgentの概要.md](./02_DirectorAgentの概要.md)を参照。

## 3. 機能要件

DirectorAgentで実装すべき具体的な機能（Issue取得、優先度判断、タスク振り分け等）の詳細仕様について記載。詳細は、[03_機能要件.md](./03_機能要件.md)を参照。

## 4. 非機能要件

DirectorAgentの性能、可用性、セキュリティ等の非機能的な品質要件について記載。詳細は、[04_非機能要件.md](./04_非機能要件.md)を参照。

## 5. エージェント間インターフェース

DirectorAgentと他のエージェント（DevPlanner Agents、不具合分析 Agents等）との連携方式について調査した結果について記載。詳細は、[05_エージェント間インターフェース.md](./05_エージェント間インターフェース.md)を参照。

## 6. シーケンス図

DirectorAgentの動作フローを時系列で表現したシーケンス図について記載。詳細は、[06_シーケンス図.md](./06_シーケンス図.md)を参照。

***

[目次](#はじめに)
