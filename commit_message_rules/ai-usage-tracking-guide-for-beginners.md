# 工数・AI活用記録システム 初心者ガイド

## 目次

- [このドキュメントは何？](#このドキュメントは何)
- [1. あなたがやること（たった2つ！）](#1-あなたがやることたった2つ)
  - [やること① コミット時に作業記録を書く](#やること-コミット時に作業記録を書く)
  - [やること② PR作成時に作業記録を書く](#やること-pr作成時に作業記録を書く)
- [2. 自動チェックの仕組み（記入漏れを防ぐ）](#2-自動チェックの仕組み記入漏れを防ぐ)
- [3. 全体の流れを図で見る](#3-全体の流れを図で見る)
- [4. 関連ファイルはどこにある？](#4-関連ファイルはどこにある)
- [5. 今できること・できないこと](#5-今できることできないこと)
- [6. よくある質問（FAQ）](#6-よくある質問faq)
- [7. 付録: API使用料の確認方法](#7-付録-api使用料の確認方法)
- [8. まとめ](#8-まとめ)
- [参考リンク](#参考リンク)

---

## このドキュメントは何？

このドキュメントでは、**「作業にかかった時間」と「AIをどれくらい使ったか」を記録する仕組み**について説明します。

### なぜ記録が必要なの？

1. **AIの効果を測る** - AIを使うとどれくらい時間が短縮できたか知りたい
2. **コストを把握する** - AI利用にかかる費用を管理したい
3. **チームで共有する** - 誰がどんな作業をしたか見えるようにしたい

---

## 1. あなたがやること（たった2つ！）

### やること① コミット時に作業記録を書く

コミットとは、コードの変更を保存することです。その時に「どれくらい時間がかかったか」を一緒に記録します。

#### 書く場所

コミットメッセージ（変更内容の説明文）の中に書きます。

#### 書くフォーマット

```
何をしたか: 簡単な説明

詳細な説明（任意）

AI: 使ったAI | 時間: AIを使った時間 | 費用: かかったお金
実作業: 自分が作業した時間 | AI未使用想定: AIなしだったら何時間かかったか
活用度: どれくらいAIに頼ったか

Co-Authored-By: Claude <noreply@anthropic.com>
```

#### 書く項目は5つ

| 項目 | 何を書く？ | 書き方の例 |
|------|----------|-----------|
| **実作業時間** | あなたが実際に作業した時間 | `1h 30m`（1時間30分） |
| **AI使用時間** | AIを使っていた時間 | `0h 45m`（45分） |
| **API使用料** | AIの利用料金（わからなければ$0.00でOK） | `$0.30` |
| **AI未使用想定時間** | もしAIを使わなかったら何時間かかった？ | `4h 00m`（4時間） |
| **AI活用度** | どれくらいAIに頼った？（下の表から選ぶ） | `高` |

#### 「AI活用度」はどれを選ぶ？

| 選択肢 | どんな時？ | 具体例 |
|--------|----------|--------|
| **低** | ほぼ自分で作業、AIはちょっと手伝っただけ | 自分でコードを書いて、AIには文法チェックだけ頼んだ |
| **中** | 自分とAI、半々くらいで作業した | 設計は自分、コードの一部はAIに書いてもらった |
| **高** | AIがメインで作業、自分は確認・修正 | AIにコードを書いてもらい、自分はレビューして直した |
| **非常に高** | ほぼAI、自分は指示と確認だけ | やりたいことを伝えたらAIがほぼ全部やってくれた |

#### 実際の例

```
Add: SSH接続のリトライ機能

接続が失敗したとき、自動で最大3回まで再接続する機能を追加しました。

AI: Claude Code | 時間: 0h 45m | 費用: $0.30
実作業: 1h 00m | AI未使用想定: 3h 00m
活用度: 高

Co-Authored-By: Claude <noreply@anthropic.com>
```

この例の意味：
- 自分の作業時間は1時間
- そのうちAIを使ったのは45分
- AIを使わなかったら3時間かかっていた（2時間短縮！）
- AIがメインで作業し、自分は確認・修正した（活用度：高）

---

### やること② PR作成時に作業記録を書く

PRとは「Pull Request」の略で、「この変更をコードに取り込んでください」というお願いのことです。

#### 書く内容

PRを作成すると、テンプレート（ひな形）が自動で表示されます。その中の「工数・AI活用記録」セクションを埋めます。

#### AIサービス別の記録表

使ったAIサービスごとに時間と費用を記入します。

```markdown
| AIサービス | 使用時間 | API使用料 | 用途 |
|-----------|---------|----------|------|
| Claude Code | 2h 00m | $1.50 | コード生成・レビュー |
| GitHub Copilot | 0h 30m | - | 補完機能 |
```

#### 合計の記録表

全体の時間を記入します。

```markdown
| 項目 | 時間 |
|------|------|
| 実作業時間 | 3h 00m |
| AI使用時間（上記合計） | 2h 30m |
| AI未使用時の想定作業時間 | 8h 00m |
```

#### AI活用度の選択

チェックボックスで1つ選びます（マウスでクリックするだけ）。

- [ ] 低 (0-25%)
- [ ] 中 (26-50%)
- [x] 高 (51-75%)  ← このように1つだけチェック
- [ ] 非常に高 (76-100%)

---

## 2. 自動チェックの仕組み（記入漏れを防ぐ）

PRを作成すると、**自動でチェックが走ります**。記入漏れがあると教えてくれます。

### どんなチェックがあるの？

| チェック名 | いつ動く？ | 何をチェック？ |
|-----------|----------|---------------|
| **工数記録チェック** | PR作成時 | 作業時間やAI活用度が書いてあるか |
| **設計チェック** | mainへのPR時 | 設計書と実際のコードが合っているか |
| **進捗チェック** | 進捗ファイル変更時 | 「完了」と書いたものが本当に完了しているか |
| **コードレビュー** | PR作成時 | AIがコードの品質をチェック |

### 工数記録チェックの詳細

一番よく使う「工数記録チェック」について説明します。

#### チェックされる内容

```
1. 「工数・AI活用記録」セクションがあるか？
   → なければエラー（PRをマージできない）

2. 「実作業時間」が「0h 00m」のままじゃないか？
   → 0h 00mのままだとエラー（PRをマージできない）

3. AI活用度を選択しているか？
   → 選んでなくても警告だけ（マージはできる）
```

#### チェック結果の例

**うまくいった場合:**
```
✅ すべてのチェックに合格しました
```

**ダメだった場合:**
```
❌ エラー: 実作業時間が記入されていません（0h 00mのまま）
⚠️ 警告: AI活用度が選択されていません
```

#### エラーと警告の違い

| 種類 | マージできる？ | 対応 |
|------|--------------|------|
| **エラー** | できない | 必ず直す |
| **警告** | できる | できれば直す |

### 設計チェック・進捗チェックについて

これらは主に**mainブランチへのPR**で動きます。

- **設計チェック**: 設計書に「この機能を作る」と書いてあるのに、実際のコードにないとエラー
- **進捗チェック**: 進捗表に「完了」と書いてあるのに、実際のコードにないとエラー

---

## 3. 全体の流れを図で見る

```
┌─────────────────────────────────────────────────────────────────┐
│                      PRを作成する                               │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
        ┌─────────────────────────────────────────────┐
        │  自動チェックが動く（GitHub Actions）        │
        └─────────────────────────────────────────────┘
                              │
          ┌───────────────────┼───────────────────┐
          ▼                   ▼                   ▼
   ┌──────────────┐   ┌──────────────┐   ┌──────────────┐
   │ 工数記録     │   │ 設計チェック │   │ コード       │
   │ チェック     │   │（main向け）  │   │ レビュー     │
   └──────────────┘   └──────────────┘   └──────────────┘
          │                   │                   │
          ▼                   ▼                   ▼
   ┌──────────────┐   ┌──────────────┐   ┌──────────────┐
   │ 記入漏れが   │   │ 設計と実装の │   │ コードの     │
   │ ないか確認   │   │ 不一致を検出 │   │ 問題を指摘   │
   └──────────────┘   └──────────────┘   └──────────────┘
                              │
                              ▼
        ┌─────────────────────────────────────────────┐
        │  結果がPRにコメントとして表示される          │
        │  エラーがあればPRをマージできない            │
        └─────────────────────────────────────────────┘
```

---

## 4. 関連ファイルはどこにある？

覚えなくても大丈夫ですが、知っておくと便利なファイル一覧です。

```
ssh-ops-agent/
│
├── CLAUDE.md                    ← AIへの指示書（このルールが書いてある）
│
├── .gitmessage                  ← コミットメッセージのひな形
│
└── .github/
    │
    ├── pull_request_template.md ← PRのひな形（これを埋める）
    │
    └── workflows/               ← 自動チェックのプログラム
        ├── pr-effort-tracking-check.yaml    ← 工数記録チェック
        ├── doc-implementation-consistency.yaml ← 設計チェック
        ├── progress-doc-consistency.yaml    ← 進捗チェック
        └── claude-pr-review.yaml            ← コードレビュー
```

---

## 5. 今できること・できないこと

### できること（実装済み）

| 機能 | 説明 |
|------|------|
| 作業記録の記入 | コミットやPRに時間を書ける |
| 記入漏れチェック | 書き忘れを自動で教えてくれる |

### まだできないこと（今後の予定）

| 機能 | 説明 |
|------|------|
| 自動集計 | 記録したデータを自動でまとめる |
| チームレポート | チーム全体の工数を見える化 |
| コスト分析 | AIの利用料金を分析 |
| 効果の可視化 | AIでどれくらい時間を節約できたか |

**つまり今は「記録するだけ」の段階です。集計は手動でやる必要があります。**

---

## 6. よくある質問（FAQ）

### Q: 時間がわからない場合は？

**A:** だいたいの時間で大丈夫です。正確でなくても、目安として記録しましょう。

### Q: APIの使用料がわからない場合は？

**A:** `$0.00` と書いてください。わからない場合は0でOKです。

ただし、確認する方法はいくつかあります。詳しくは下の「API使用料の確認方法」を参照してください。

### Q: AI活用度の判断に迷ったら？

**A:** 迷ったら「中」か「高」を選べばOKです。厳密な判断は求められていません。

### Q: 記入を忘れてPRを出してしまった！

**A:** 大丈夫です。自動チェックがエラーを出すので、PRの説明文を編集して記入してください。編集するとチェックが再実行されます。

### Q: Claude Codeを使っている場合は？

**A:** Claude Codeにコミットを頼むと、自動で工数記録のヒアリングをしてくれます。答えるだけでOKです。

---

## 7. 付録: API使用料の確認方法

API使用料を調べる方法は複数あります。自分の環境に合った方法を選んでください。

### 方法① `/cost` コマンド（一番簡単）

Claude Codeのセッション中に `/cost` と入力すると、**現在のセッションの使用料**が表示されます。

```
❯ /cost
Total cost:            $0.82
Total duration (API):  2m 29s
Total duration (wall): 14m 22s
Usage by model:
        claude-haiku:  447 input, 186 output ($0.0014)
     claude-opus-4-5:  20 input, 8.6k output ($0.82)
```

**ポイント:**
- セッションごとの合計が表示される
- 過去のセッションは `/resume` で入り直せば確認できる

### 方法② Anthropic Console（公式ダッシュボード）

Anthropic APIを直接使っている場合は、公式コンソールで確認できます。

- **URL:** https://console.anthropic.com
- 「Usage」セクションで使用量と費用を確認

### 方法③ AWS Cost Explorer（Bedrock経由の場合）

AWS Bedrock経由でClaudeを使っている場合は、AWSの管理画面で確認します。

- **AWS Cost Explorer** - 日別・サービス別のコストを確認
- **AWS Billing Dashboard** - 請求の詳細を確認
- **CloudWatch** - メトリクスを監視

### 方法④ ccusage（自動集計ツール）

複数セッションの使用料を自動で集計してくれるサードパーティツールがあります。

- **ccusage:** https://github.com/ryoppippi/ccusage
- Claude Codeの使用履歴を自動で集計してくれる

### 方法⑤ 手動計算（トークン数から）

トークン数がわかれば、料金表から計算できます。

#### モデル別の料金表（2025年時点）

| モデル | 入力 | 出力 |
|--------|------|------|
| **Claude Opus 4.5** | $15 / 100万トークン | $75 / 100万トークン |
| **Claude Sonnet 4** | $3 / 100万トークン | $15 / 100万トークン |
| **Claude Haiku** | $0.25 / 100万トークン | $1.25 / 100万トークン |

#### 計算式

```
コスト = (入力トークン × 入力単価) + (出力トークン × 出力単価)
```

#### 計算例

Claude Opus 4.5で、入力10,000トークン、出力5,000トークンの場合：

```
入力: 10,000 × ($15 / 1,000,000) = $0.15
出力:  5,000 × ($75 / 1,000,000) = $0.375
合計: $0.525
```

### どの方法を選ぶ？

| 状況 | おすすめの方法 |
|------|---------------|
| Claude Codeを使っている | `/cost` コマンド |
| Anthropic APIを直接使っている | Anthropic Console |
| AWS Bedrock経由で使っている | AWS Cost Explorer |
| 複数セッションをまとめて確認したい | ccusage |
| トークン数しかわからない | 手動計算 |

### 開発者向け情報

#### Claude Agent SDKの場合

SDKの戻り値にcost情報が含まれています。プログラムから取得可能です。

#### S3アップローダーの出力から計算する場合

会話履歴ファイルには以下のトークン情報が含まれています：

```json
{
  "usage": {
    "input_tokens": 9,
    "output_tokens": 1234,
    "cache_creation_input_tokens": 641,
    "cache_read_input_tokens": 17597
  },
  "model": "claude-opus-4-5-20251101"
}
```

ドル金額は含まれていないため、上記の料金表を使って計算が必要です。

---

## 8. まとめ

| ポイント | 内容 |
|---------|------|
| **やること** | コミットとPRに作業時間を5項目書くだけ |
| **チェック** | 書き忘れは自動で検出される |
| **注意点** | エラーがあるとPRをマージできない |
| **目的** | AIをどれくらい活用したか記録して、効果を測れるようにする |

---

## 参考リンク

- [CLAUDE.md](/CLAUDE.md) - ルールの詳細
- [PRテンプレート](/.github/pull_request_template.md) - PRのひな形
- [コミットテンプレート](/.gitmessage) - コミットのひな形
